<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coordonn√©es cart√©siennes et polaires</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            startup: {
                pageReady: () => {
                    return MathJax.startup.defaultPageReady();
                }
            }
        };
    </script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .section-title {
            color: #7850a0;
            font-size: 1.8em;
            font-weight: bold;
            margin-top: 30px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .arrow {
            color: #7850a0;
            font-size: 2em;
            margin-right: 10px;
        }
        
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            line-height: 1.8;
        }
        
        .info-box {
            background-color: #f0f0f0;
            border: 3px solid #c04040;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            display: flex;
            align-items: center;
        }
        
        .info-icon {
            background-color: #c04040;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-style: italic;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            flex-wrap: wrap;
        }
        
        .text-content {
            flex: 1;
            min-width: 300px;
        }
        
        .figure-container {
            flex: 0 0 500px;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        #svg-container {
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            background-color: white;
        }
        
        svg text {
            user-select: none;
            pointer-events: none;
        }
        
        .draggable {
            cursor: move;
        }
        
        .instructions {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .figure-container {
                flex: 1 1 auto;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1 style="text-align: center; color: #7850a0;">Coordonn√©es dans le plan</h1>
    
    <div class="content">
        <div class="section-title">
            <span class="arrow">‚ûú</span>
            Coordonn√©es cart√©siennes
        </div>
        
        <p>
            Tout point M du plan est rep√©r√© par un unique couple $(x;y)$ de nombres r√©els tels que 
            $\overrightarrow{\text{OM}} = x\,\vec{i} + y\,\vec{j}$.
            $(x;y)$ est appel√© couple de <strong>coordonn√©es cart√©siennes</strong> du point M dans le rep√®re 
            $(\text{O};\vec{i},\vec{j})$.
        </p>
        
        <div class="info-box">
            <div class="info-icon">i</div>
            <div>
                Si $\text{A}(x_A;y_A)$ et $\text{B}(x_B;y_B)$, alors 
                $\text{AB} = \sqrt{(x_B - x_A)^2 + (y_B - y_A)^2}$
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="text-content">
            <div class="content">
                <div class="section-title">
                    <span class="arrow">‚ûú</span>
                    Coordonn√©es polaires
                </div>
                
                <p>
                    Tout point M du plan distinct de O est rep√©r√© par un couple $(r;\theta)$ de 
                    nombres r√©els avec $r>0$, appel√© couple de <strong>coordonn√©es polaires</strong> du 
                    point M, tel que $r = \text{OM}$ et $\theta = (\vec{i};\overrightarrow{\text{OM}})$ 
                    (en radians).
                </p>
            </div>
            
            <div class="content">
                <div class="section-title">
                    <span class="arrow">‚ûú</span>
                    Lien entre coordonn√©es cart√©siennes et coordonn√©es polaires
                </div>
                
                <p>
                    Si un point M distinct de O a pour coordonn√©es cart√©siennes $(x;y)$ et pour 
                    coordonn√©es polaires $(r;\theta)$, alors :
                    $r = \sqrt{x^2 + y^2}$ ; $x = r\cos\theta$ et $y = r\sin\theta$.
                </p>
            </div>
        </div>
        
        <div class="figure-container">
            <h3 style="text-align: center; color: #7850a0;">Figure interactive</h3>
            <div id="svg-container"></div>
            <div class="instructions">
                üí° <strong>D√©placer le point M</strong> : cliquer-glisser directement sur le point M
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const width = 500;
        const height = 400;
        // Centrer le rep√®re
        const centerX = width / 2;
        const centerY = height / 2;
        
        // Cr√©ation du SVG
        const svg = d3.select("#svg-container")
            .append("svg")
            .attr("width", width)
            .attr("height", height);
        
        // Grille centr√©e
        const gridGroup = svg.append("g").attr("class", "grid");
        
        // Lignes verticales
        for (let i = -Math.floor(width/60); i <= Math.floor(width/60); i++) {
            const x = centerX + i * 30;
            gridGroup.append("line")
                .attr("x1", x).attr("y1", 0)
                .attr("x2", x).attr("y2", height)
                .attr("stroke", "#e0e0e0")
                .attr("stroke-width", 0.5)
                .attr("stroke-dasharray", "2,2");
        }
        
        // Lignes horizontales
        for (let i = -Math.floor(height/60); i <= Math.floor(height/60); i++) {
            const y = centerY + i * 30;
            gridGroup.append("line")
                .attr("x1", 0).attr("y1", y)
                .attr("x2", width).attr("y2", y)
                .attr("stroke", "#e0e0e0")
                .attr("stroke-width", 0.5)
                .attr("stroke-dasharray", "2,2");
        }
        
        // D√©finition des fl√®ches fines
        const defs = svg.append("defs");
        
        defs.append("marker")
            .attr("id", "arrowhead")
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("refX", 5)
            .attr("refY", 2)
            .attr("orient", "auto")
            .append("polygon")
            .attr("points", "0 0, 6 2, 0 4")
            .attr("fill", "#999");
        
        defs.append("marker")
            .attr("id", "arrowhead-red")
            .attr("markerWidth", 5)
            .attr("markerHeight", 5)
            .attr("refX", 4)
            .attr("refY", 2)
            .attr("orient", "auto")
            .append("polygon")
            .attr("points", "0 0, 5 2, 0 4")
            .attr("fill", "#c04040");
        
        // Axe des x avec sym√©trie
        svg.append("line")
            .attr("x1", 20).attr("y1", centerY)
            .attr("x2", width - 20).attr("y2", centerY)
            .attr("stroke", "#999")
            .attr("stroke-width", 1.5)
            .attr("marker-end", "url(#arrowhead)");
        
        // Axe des y avec sym√©trie
        svg.append("line")
            .attr("x1", centerX).attr("y1", height - 20)
            .attr("x2", centerX).attr("y2", 20)
            .attr("stroke", "#999")
            .attr("stroke-width", 1.5)
            .attr("marker-end", "url(#arrowhead)");
        
        // Labels des axes
        svg.append("text")
            .attr("x", width - 25)
            .attr("y", centerY - 10)
            .text("x")
            .attr("font-size", "18px")
            .attr("fill", "#666");
        
        svg.append("text")
            .attr("x", centerX + 10)
            .attr("y", 30)
            .text("y")
            .attr("font-size", "18px")
            .attr("fill", "#666");
        
        // Origine O
        svg.append("text")
            .attr("x", centerX - 15)
            .attr("y", centerY + 20)
            .text("O")
            .attr("font-size", "16px")
            .attr("fill", "#333")
            .attr("font-weight", "bold");
        
        // Vecteur i de base (rouge fin)
        svg.append("line")
            .attr("x1", centerX)
            .attr("y1", centerY)
            .attr("x2", centerX + 50)
            .attr("y2", centerY)
            .attr("stroke", "#c04040")
            .attr("stroke-width", 1.5)
            .attr("marker-end", "url(#arrowhead-red)");
        
        svg.append("text")
            .attr("x", centerX + 25)
            .attr("y", centerY + 20)
            .html("&#8407;")
            .attr("font-size", "16px")
            .attr("fill", "#c04040")
            .attr("font-weight", "bold");
        
        svg.append("text")
            .attr("x", centerX + 30)
            .attr("y", centerY + 20)
            .text("i")
            .attr("font-size", "14px")
            .attr("fill", "#c04040")
            .attr("font-weight", "bold")
            .attr("font-style", "italic");
        
        // Vecteur j de base (rouge fin)
        svg.append("line")
            .attr("x1", centerX)
            .attr("y1", centerY)
            .attr("x2", centerX)
            .attr("y2", centerY - 50)
            .attr("stroke", "#c04040")
            .attr("stroke-width", 1.5)
            .attr("marker-end", "url(#arrowhead-red)");
        
        svg.append("text")
            .attr("x", centerX - 25)
            .attr("y", centerY - 20)
            .html("&#8407;")
            .attr("font-size", "16px")
            .attr("fill", "#c04040")
            .attr("font-weight", "bold");
        
        svg.append("text")
            .attr("x", centerX - 20)
            .attr("y", centerY - 20)
            .text("j")
            .attr("font-size", "14px")
            .attr("fill", "#c04040")
            .attr("font-weight", "bold")
            .attr("font-style", "italic");
        
        // Lignes de projection en pointill√©s (seront mises √† jour)
        const projectionX = svg.append("line")
            .attr("stroke", "#999")
            .attr("stroke-width", 1)
            .attr("stroke-dasharray", "4,4");
        
        const projectionY = svg.append("line")
            .attr("stroke", "#999")
            .attr("stroke-width", 1)
            .attr("stroke-dasharray", "4,4");
        
        // Points de projection sur les axes
        const projPointX = svg.append("circle")
            .attr("r", 4)
            .attr("fill", "#7850a0");
        
        const projPointY = svg.append("circle")
            .attr("r", 4)
            .attr("fill", "#7850a0");
        
        // Labels des coordonn√©es sur les axes
        const xCoordLabel = svg.append("text")
            .attr("font-size", "14px")
            .attr("fill", "#7850a0")
            .attr("font-weight", "bold");
        
        const yCoordLabel = svg.append("text")
            .attr("font-size", "14px")
            .attr("fill", "#7850a0")
            .attr("font-weight", "bold");
        
        // Arc d'angle
        const arcPath = svg.append("path")
            .attr("fill", "none")
            .attr("stroke", "#c04040")
            .attr("stroke-width", 2);
        
        // Ligne OM (rayon) - SANS FL√àCHE
        const radiusLine = svg.append("line")
            .attr("stroke", "#c04040")
            .attr("stroke-width", 2);
        
        // Label du rayon
        const radiusLabel = svg.append("text")
            .attr("fill", "#c04040")
            .attr("font-size", "14px")
            .attr("font-weight", "bold");
        
        // Label de l'angle
        const angleLabel = svg.append("text")
            .attr("fill", "#c04040")
            .attr("font-size", "16px")
            .attr("font-style", "italic")
            .attr("font-weight", "bold");
        
        // Point M
        const pointM = svg.append("circle")
            .attr("r", 8)
            .attr("fill", "#333")
            .attr("class", "draggable")
            .style("cursor", "move");
        
        const labelM = svg.append("text")
            .attr("font-size", "16px")
            .attr("fill", "#333")
            .attr("font-weight", "bold");
        
        // Fonction de mise √† jour
        function updateVisualization(r, thetaDeg) {
            const thetaRad = thetaDeg * Math.PI / 180;
            const x = r * Math.cos(thetaRad);
            const y = r * Math.sin(thetaRad);
            
            const pointX = centerX + x;
            const pointY = centerY - y;
            
            // Mise √† jour du point M
            pointM.attr("cx", pointX).attr("cy", pointY);
            labelM.attr("x", pointX + 12).attr("y", pointY - 12).text("M");
            
            // Mise √† jour du rayon (sans fl√®che)
            radiusLine
                .attr("x1", centerX).attr("y1", centerY)
                .attr("x2", pointX).attr("y2", pointY);
            
            // Label du rayon
            radiusLabel
                .attr("x", centerX + x * 0.4 - 15)
                .attr("y", centerY - y * 0.4 - 5)
                .text(`r = ${r.toFixed(0)}`);
            
            // Mise √† jour de l'arc
            const arcRadius = 50;
            const largeArcFlag = Math.abs(thetaDeg) > 180 ? 1 : 0;
            const sweepFlag = thetaDeg >= 0 ? 0 : 1;
            
            const endX = centerX + arcRadius * Math.cos(thetaRad);
            const endY = centerY - arcRadius * Math.sin(thetaRad);
            
            const arcPathData = [
                `M ${centerX + arcRadius} ${centerY}`,
                `A ${arcRadius} ${arcRadius} 0 ${largeArcFlag} ${sweepFlag} ${endX} ${endY}`
            ].join(' ');
            
            arcPath.attr("d", arcPathData);
            
            // Label de l'angle
            const labelAngle = thetaDeg / 2;
            const labelRad = labelAngle * Math.PI / 180;
            const labelDistance = 65;
            angleLabel
                .attr("x", centerX + labelDistance * Math.cos(labelRad))
                .attr("y", centerY - labelDistance * Math.sin(labelRad) + 5)
                .text(`Œ∏ = ${thetaDeg.toFixed(0)}¬∞`);
            
            // Projections sur les axes
            projectionX
                .attr("x1", pointX).attr("y1", pointY)
                .attr("x2", pointX).attr("y2", centerY);
            
            projectionY
                .attr("x1", pointX).attr("y1", pointY)
                .attr("x2", centerX).attr("y2", pointY);
            
            // Points de projection
            projPointX
                .attr("cx", pointX)
                .attr("cy", centerY);
            
            projPointY
                .attr("cx", centerX)
                .attr("cy", pointY);
            
            // Labels des coordonn√©es sur les axes
            xCoordLabel
                .attr("x", pointX - 25)
                .attr("y", centerY + 20)
                .text(`x = ${x.toFixed(1)}`);
            
            yCoordLabel
                .attr("x", centerX + 10)
                .attr("y", pointY - 10)
                .text(`y = ${y.toFixed(1)}`);
        }
        
        // Gestion du drag pour le point M
        const dragPointM = d3.drag()
            .on("drag", function(event) {
                // Coordonn√©es de la souris
                const mouseX = event.x;
                const mouseY = event.y;
                
                // Calculer les coordonn√©es relatives √† l'origine O
                const relX = mouseX - centerX;
                const relY = centerY - mouseY;
                
                // Calculer r et Œ∏
                const r = Math.sqrt(relX * relX + relY * relY);
                let theta = Math.atan2(relY, relX) * 180 / Math.PI;
                
                // Normaliser Œ∏ entre 0 et 360 degr√©s
                if (theta < 0) theta += 360;
                
                // Limiter r entre 0 et 200
                const limitedR = Math.max(0, Math.min(200, r));
                
                requestAnimationFrame(() => updateVisualization(limitedR, theta));
            });
        
        pointM.call(dragPointM);
        
        // Initialisation
        updateVisualization(150, 40);
    </script>
</body>
</html>
